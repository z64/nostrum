<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.18.3">
    <title>State – Elixir v0.3.0</title>
    <link rel="stylesheet" href="dist/app-480ffdc169.css" />
    
    <script src="dist/sidebar_items-bff09e43e5.js"></script>
    
    
    
    
  </head>
  <body data-type="extras">
    <script>try { if(localStorage.getItem('night-mode')) document.body.className += ' night-mode'; } catch (e) { }</script>

<div class="main">
<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" aria-hidden="true"></span>
  <span class="sr-only">Toggle Sidebar</span>
</button>
<button class="sidebar-button night-mode-toggle">
  <span class="icon-theme" aria-hidden="true"></span>
  <span class="sr-only">Toggle Theme</span>
</button>
<section class="sidebar">

  
  <a href="https://github.com/kraigie/nostrum" class="sidebar-projectLink">
    <div class="sidebar-projectDetails">
      <h1 class="sidebar-projectName">
        Elixir
      </h1>
      <h2 class="sidebar-projectVersion">
        v0.3.0
      </h2>
    </div>
    
  </a>

  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <input name="q" type="text" id="search-list" class="search-input" placeholder="Search" aria-label="Search" autocomplete="off" />
  </form>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>

    
      <li><a id="modules-list" href="#full-list">Modules</a></li>
    

    
      <li><a id="exceptions-list" href="#full-list">Exceptions</a></li>
    

    
      <li><a id="tasks-list" href="#full-list">Mix Tasks</a></li>
    
  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">


<h1>State</h1>
<p>Nostrum keeps track of the state that your bot can see. This state is updated
based on events from the WS connection. Most of the cache modules support only
simple interactions with the cache. Feel free to suggest additional functionality.</p>
<h2 id="structs" class="section-heading">
  <a href="#structs" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Structs
</h2>

<p>Nostrum uses structs when appropriate to pass around objects from Discord.</p>
<p>In some cases, the struct modules will include helper functions for interacting
with the struct. See <code class="inline">Nostrum.Struct.Emoji.format_custom_emoji/2</code> for an example.</p>
<h2 id="guilds" class="section-heading">
  <a href="#guilds" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Guilds
</h2>

<p>Each guild is ran in its own <a href="https://hexdocs.pm/elixir/GenServer.html"><code class="inline">GenServer</code></a> process, all of which are ran under a
supervisor. Behind the scenes, Nostrum uses the <a href="https://hexdocs.pm/elixir/Registry.html"><code class="inline">Registry</code></a> module to
map guild ids to a <code class="inline">pid</code> to allow for lookup.</p>
<p>Please see <a href="Nostrum.Cache.Guild.GuildServer.html"><code class="inline">Nostrum.Cache.Guild.GuildServer</code></a> for more information on interacting with
guilds.</p>
<h2 id="channels" class="section-heading">
  <a href="#channels" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Channels
</h2>

<p>DM channels are all stored in a single map in a single <a href="https://hexdocs.pm/elixir/GenServer.html"><code class="inline">GenServer</code></a>. Guild channels
are stored in their respective guilds.</p>
<p>Channels aren’t important enough to have their own process per channel, and the
current implementation is not done well, in the future this will likely be moved
to an ETS backed cache like users are, but the interface will remain the same.</p>
<p>Please see <a href="Nostrum.Cache.ChannelCache.html"><code class="inline">Nostrum.Cache.ChannelCache</code></a> for more information on interacting with
channels. Though they’re stored in different places, the interface hides that fact.</p>
<h2 id="users" class="section-heading">
  <a href="#users" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Users
</h2>

<p>Users are all stored in an ETS table, keyed off of their id.</p>
<p>To see the name of the ETS table associated with the user cache, and examples of
interacting with it both directly and through the provided abstractions, please
see <a href="Nostrum.Cache.UserCache.html"><code class="inline">Nostrum.Cache.UserCache</code></a>.</p>
<h2 id="mappings" class="section-heading">
  <a href="#mappings" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Mappings
</h2>

<p>There are some use cases where given a <code class="inline">channel_id</code> or <code class="inline">guild_id</code> we may want to
find the <code class="inline">guild</code> or <code class="inline">shard</code> that the <code class="inline">id</code> belongs to. For this purpose Nostrum
stores these types of relations in ETS tables.</p>
<p>The following mappings exists.</p>
<pre><code class="Elixir">guild_channel_id -&gt; guild_id
guild_id -&gt; shard_num
shard_num_num -&gt; shard_pid</code></pre>
<p>Please see <a href="Nostrum.Cache.Mapping.ChannelGuild.html"><code class="inline">Nostrum.Cache.Mapping.ChannelGuild</code></a> for one such map.</p>

      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" rel="help" target="_blank">ExDoc</a> (v0.18.3),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" title="@dignifiedquire">Friedel Ziegelmayer</a>.
            </span>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  <script src="dist/app-9bd040e5e5.js"></script>
  
  
  
  
  </body>
</html>

